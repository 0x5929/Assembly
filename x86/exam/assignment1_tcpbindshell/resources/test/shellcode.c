#include <stdio.h>
#include <string.h>

/**
	REMEMBER THAT SHELLCODE FROM ONLINE IS NEVER TRUSTED, 
	ALWAYS RUN IT IN A VIRTUAL ENVIRONMENT AND NOT YOUR ACTUAL MACHINE
	AKA A TESTING SANDBOX 
*/

unsigned char code[] = \
"\x83\xc4\x04\x8f\x05\xf8\x90\x04\x08\x8b\x0d\xf8\x90\x04\x08\xe8\x3d\x00\x00\x00\xe8\x4d\x00\x00\x00\x8f\x05\xfc\x90\x04\x08\x8b\x0d\xfc\x90\x04\x08\xe8\x27\x00\x00\x00\xe8\x37\x00\x00\x00\x8f\x05\x00\x91\x04\x08\x8b\x0d\x00\x91\x04\x08\xe8\x11\x00\x00\x00\xe8\x21\x00\x00\x00\xb8\x01\x00\x00\x00\xbb\x05\x00\x00\x00\xcd\x80\x55\x89\xe5\x51\xba\x00\x00\x00\x00\x49\x42\x41\x80\x39\x00\x75\xf9\x4a\x59\xc9\xc3\x55\x89\xe5\xb8\x04\x00\x00\x00\xbb\x01\x00\x00\x00\xcd\x80\xc9\xc3";


int main(int argc, char** argv)
{
	printf("Shellcode Length: %d\n", strlen(code));
	
	// define a pointer to a type int function name ret, and it takes no arguments
	// initialize it to a type int function pointer that takes no arguments casted on shellcode

	int (*ret)() = (int(*)())code;

	// running the pointer function
	ret(argv);

	return 0;
}
